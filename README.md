# Cервис Gophermart - накопительная система лояльности

## Сервис имеет следующий функционал
- регистрация, аутентификация и авторизация пользователей;
- приём номеров заказов от зарегистрированных пользователей;
- учёт и ведение списка переданных номеров заказов зарегистрированного пользователя;
- учёт и ведение накопительного счёта зарегистрированного пользователя;
- проверка принятых номеров заказов через систему расчёта баллов лояльности;
- начисление за каждый подходящий номер заказа положенного вознаграждения на счёт лояльности пользователя

## Запуск и настройка сервиса
Основная _gophermart_ команда имеет следующий вид:

`_gophermart_ [OPTIONS]`

Пользователь имеет возможность менять или устанавливать следующие параметры, путем установки флага `[OPTIONS]` или переменной окружения:

- флаг `-a`, переменная окружения `RUN_ADDRESS` - адрес запуска сервиса Gophermart _(localhost:8081, :8081) по умолчанию сервис запускается на порту 8080_
- флаг `-d`, переменная окружения `DATABASE_URI` - адрес подключения к БД Postgres _(host=localhost user=user password=pass database=gophermart sslmode=disable)_
- флаг `-r`, переменная окружения `ACCRUAL_SYSTEM_ADDRESS` - адрес подключения к сервису расчёта начислений баллов лояльности _(192.168.1.10:8080)_
- флаг `-l`, переменная окружения `LOG_LEVEL` - выбор уровня логирования _(info, debug, warn, error, dpanic, panic, fatal) по умолчанию установлен уровень info_
- флаг `-k`, переменная окружения `SECRET_KEY` - установка 16 битного ключа в кодировке Base64 для подписи cookie _(p4tUPmWlYDyQFg13nDyLoA==)_, в случае если ключ не установлен, сервис при запуске генерирует случайный 16 битный ключ

# Сводное HTTP API
Накопительная система лояльности «Гофермарт» предоставляет следующие ендепоинты для взаимодействия:

- POST /api/user/register — регистрация пользователя;
- POST /api/user/login — аутентификация пользователя;
- POST /api/user/orders — загрузка пользователем номера заказа для расчёта;
- GET /api/user/orders — получение списка загруженных пользователем номеров заказов, статусов их обработки и информации о начислениях;
- GET /api/user/balance — получение текущего баланса счёта баллов лояльности пользователя;
- POST /api/user/balance/withdraw — запрос на списание баллов с накопительного счёта в счёт оплаты нового заказа;
- GET /api/user/withdrawals — получение информации о выводе средств с накопительного счёта пользователем.
